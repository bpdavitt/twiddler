<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>

    <script>

      $(document).ready(function(){
        //var $body = $('body');
        //$body.html('');

        var userTweets = function(handle){
          var $tweetContainer = $('.tweet-container');
          $tweetContainer.html('');
          
          
          var index = 0;
          while(index < streams.users[handle].length){ //variable userIndex is below var index above
            var tweet = streams.users[handle][index]; //referencing the tweet from data_generator.js
            var $tweet = $('<div class = "tweet"></div>');
            var $handle = $('<div class = "handle"</div>');
            var $created = $('<div class = "created"</div>')
            var currentTime = new Date();
            var timeElapsed = Math.floor((currentTime - tweet.created_at) / 1000);

            $handle.text('@' + tweet.user);
            $handle.on('click', function(event){
              var tweeter = this.textContent.slice(1);
              userTweets(tweeter);
            });
            
            $tweet.text(tweet.message)
            $created.text(secondConverter(timeElapsed))
            $handle.prependTo($tweet);
            $created.appendTo($tweet);
            $tweet.prependTo('.tweet-container');
            index++;
          }
        };
                
        $(".new-tweets").on('click', function(){ //whenever you click new-tweets (Load new Tweets!) button, the function below will run
          var $tweetContainer = $('.tweet-container');
          $tweetContainer.html('');
          var index = 0;
          while(index < streams.home.length){
            var tweet = streams.home[index];
            var $tweet = $('<div class = "tweet"></div>');
            var $handle = $('<div class = "handle"</div>');
            var $created = $('<div class = "created"</div>');
            var currentTime = new Date();
            var timeElapsed = Math.floor((currentTime - tweet.created_at) / 1000);

            $handle.text('@' + tweet.user);
            
            $handle.on('click', function(event){
              var tweeter = this.textContent.slice(1);
              userTweets(tweeter);
            });
            
            $tweet.text(tweet.message);
            $created.text(secondConverter(timeElapsed));
            $handle.prependTo($tweet);
            $created.appendTo($tweet);
            $tweet.prependTo('.tweet-container');
            index++;
          }
        });

        function secondConverter(elapsed){
          var hours = Math.floor(elapsed/3600);
          var minutes = Math.floor(elapsed/60 - hours * 60);
          var seconds = elapsed % 60
          var time = '';
          if(hours > 1){
              time += hours + ' hours ';
          } else if(hours === 1) {
              time += hours + ' hour '
          }
          if(minutes > 1){
              time += minutes + ' minutes ';
          } else if(minutes === 1){
              time += minutes + ' minute '
          }
          if(seconds > 1){
              time += seconds + ' seconds ';
          }else if(seconds === 1){
              time += seconds + ' second '
          }
          if(hours === 0 && minutes === 0 && seconds === 0){
            return 'Just now';
          }

          return time + 'ago';
        }
        
      }); //this goes with $(document).ready function
    </script>

    <div class="btn-container"> <!-- formatting for the button below to live in -->
      <button class="new-tweets">Load new Tweets!</button> <!-- create a new button //"class" is for JS, CSS, and jQuery to target -->
    </div>
    <div class="tweet-container"></div> <!-- box container for our tweets to live in, will be appending individual tweets into this container, see inside while loop for new tweets -->

  </body>
</html>
